"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_controller_1=require("./controllers/base-controller"),product_service_1=require("../services/product-service"),sequelize_service_1=require("../services/sequelize-service"),path=require("path");let log=require("npmlog"),CredentialController=require(path.join(__dirname,"controllers/credential-controller"));const TAG="MainController";class Controller extends base_controller_1.default{constructor(e){super(Object.assign(e,{viewPath:path.join(__dirname,"views")})),sequelize_service_1.default.initialize(e.db.sequelize,e.db.models),this.addInterceptor((e,r,t)=>{log.verbose(TAG,"req.path="+e.path),log.verbose(TAG,"loggedIn="+e.isAuthenticated()),log.verbose(TAG,"req.on="+JSON.stringify(e.session)),t()}),this.routeGet("/",(e,r,t)=>{product_service_1.default.getCategories().then(e=>{log.verbose(TAG,"resp="+JSON.stringify(e)),r.locals.data=e.data,r.render("index")})})}}module.exports=Controller;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAvbWFpbi1jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbImJhc2VfY29udHJvbGxlcl8xIiwicmVxdWlyZSIsInByb2R1Y3Rfc2VydmljZV8xIiwic2VxdWVsaXplX3NlcnZpY2VfMSIsInBhdGgiLCJsb2ciLCJDcmVkZW50aWFsQ29udHJvbGxlciIsImpvaW4iLCJfX2Rpcm5hbWUiLCJUQUciLCJDb250cm9sbGVyIiwiZGVmYXVsdCIsIltvYmplY3QgT2JqZWN0XSIsInNpdGVEYXRhIiwic3VwZXIiLCJPYmplY3QiLCJhc3NpZ24iLCJ2aWV3UGF0aCIsImluaXRpYWxpemUiLCJkYiIsInNlcXVlbGl6ZSIsIm1vZGVscyIsInRoaXMiLCJhZGRJbnRlcmNlcHRvciIsInJlcSIsInJlcyIsIm5leHQiLCJ2ZXJib3NlIiwiaXNBdXRoZW50aWNhdGVkIiwiSlNPTiIsInN0cmluZ2lmeSIsInNlc3Npb24iLCJyb3V0ZUdldCIsImdldENhdGVnb3JpZXMiLCJ0aGVuIiwicmVzcCIsImxvY2FscyIsImRhdGEiLCJyZW5kZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoib0VBQUEsTUFBQUEsa0JBQUFDLFFBQUEsaUNBQ0FDLGtCQUFBRCxRQUFBLCtCQUNBRSxvQkFBQUYsUUFBQSxpQ0FHTUcsS0FBT0gsUUFBUSxRQUVyQixJQUFJSSxJQUFNSixRQUFRLFVBRWRLLHFCQUF1QkwsUUFBUUcsS0FBS0csS0FBS0MsVUFBVyxzQ0FFeEQsTUFBTUMsSUFBTSxpQkFFWixNQUFBQyxtQkFBeUJWLGtCQUFBVyxRQUN2QkMsWUFBYUMsR0FDWEMsTUFBTUMsT0FBT0MsT0FBT0gsRUFBVSxDQUFFSSxTQUFVYixLQUFLRyxLQUFLQyxVQUFXLFlBQy9ETCxvQkFBQVEsUUFBaUJPLFdBQVdMLEVBQVNNLEdBQUdDLFVBQVdQLEVBQVNNLEdBQUdFLFFBRS9EQyxLQUFLQyxlQUFlLENBQUNDLEVBQUtDLEVBQUtDLEtBQzdCckIsSUFBSXNCLFFBQVFsQixJQUFLLFlBQWNlLEVBQUlwQixNQUNuQ0MsSUFBSXNCLFFBQVFsQixJQUFLLFlBQWNlLEVBQUlJLG1CQUNuQ3ZCLElBQUlzQixRQUFRbEIsSUFBSyxVQUFZb0IsS0FBS0MsVUFBVU4sRUFBSU8sVUFDaERMLE1BR0ZKLEtBQUtVLFNBQVMsSUFBSyxDQUFDUixFQUFLQyxFQUFLQyxLQUM1QnhCLGtCQUFBUyxRQUFlc0IsZ0JBQWdCQyxLQUFLQyxJQUNsQzlCLElBQUlzQixRQUFRbEIsSUFBSyxRQUFVb0IsS0FBS0MsVUFBVUssSUFDMUNWLEVBQUlXLE9BQU9DLEtBQU9GLEVBQUtFLEtBQ3ZCWixFQUFJYSxPQUFPLGNBUW5CQyxPQUFPQyxRQUFVOUIiLCJmaWxlIjoiYXBwL21haW4tY29udHJvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCYXNlQ29udHJvbGxlciBmcm9tICcuL2NvbnRyb2xsZXJzL2Jhc2UtY29udHJvbGxlcidcbmltcG9ydCBQcm9kdWN0U2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy9wcm9kdWN0LXNlcnZpY2UnXG5pbXBvcnQgU2VxdWVsaXplU2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy9zZXF1ZWxpemUtc2VydmljZSdcbmltcG9ydCB7IFNpdGVEYXRhIH0gZnJvbSAnLi4vc2l0ZS1kZWZpbml0aW9ucydcblxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKVxuXG5sZXQgbG9nID0gcmVxdWlyZSgnbnBtbG9nJylcblxubGV0IENyZWRlbnRpYWxDb250cm9sbGVyID0gcmVxdWlyZShwYXRoLmpvaW4oX19kaXJuYW1lLCAnY29udHJvbGxlcnMvY3JlZGVudGlhbC1jb250cm9sbGVyJykpXG5cbmNvbnN0IFRBRyA9ICdNYWluQ29udHJvbGxlcidcblxuY2xhc3MgQ29udHJvbGxlciBleHRlbmRzIEJhc2VDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IgKHNpdGVEYXRhOiBTaXRlRGF0YSkge1xuICAgIHN1cGVyKE9iamVjdC5hc3NpZ24oc2l0ZURhdGEsIHsgdmlld1BhdGg6IHBhdGguam9pbihfX2Rpcm5hbWUsICd2aWV3cycpIH0pKVxuICAgIFNlcXVlbGl6ZVNlcnZpY2UuaW5pdGlhbGl6ZShzaXRlRGF0YS5kYi5zZXF1ZWxpemUsIHNpdGVEYXRhLmRiLm1vZGVscylcblxuICAgIHRoaXMuYWRkSW50ZXJjZXB0b3IoKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBsb2cudmVyYm9zZShUQUcsICdyZXEucGF0aD0nICsgcmVxLnBhdGgpXG4gICAgICBsb2cudmVyYm9zZShUQUcsICdsb2dnZWRJbj0nICsgcmVxLmlzQXV0aGVudGljYXRlZCgpKVxuICAgICAgbG9nLnZlcmJvc2UoVEFHLCAncmVxLm9uPScgKyBKU09OLnN0cmluZ2lmeShyZXEuc2Vzc2lvbikpXG4gICAgICBuZXh0KClcbiAgICB9KVxuXG4gICAgdGhpcy5yb3V0ZUdldCgnLycsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgUHJvZHVjdFNlcnZpY2UuZ2V0Q2F0ZWdvcmllcygpLnRoZW4ocmVzcCA9PiB7XG4gICAgICAgIGxvZy52ZXJib3NlKFRBRywgJ3Jlc3A9JyArIEpTT04uc3RyaW5naWZ5KHJlc3ApKVxuICAgICAgICByZXMubG9jYWxzLmRhdGEgPSByZXNwLmRhdGFcbiAgICAgICAgcmVzLnJlbmRlcignaW5kZXgnKVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgLyogdGhpcy5yb3V0ZVVzZSgobmV3IENyZWRlbnRpYWxDb250cm9sbGVyKGluaXREYXRhKSkuZ2V0Um91dGVyKCkpICovXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBDb250cm9sbGVyXG4iXX0=
